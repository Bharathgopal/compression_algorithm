#include "compression_algorithm.h"
#include "unity.h"

/* Required by the unity test framework */
void setUp()
{
}
/* Required by the unity test framework */
void tearDown()
{
}

void test_compression(void)
{
    uint8_t data_ptr1[] = {0x03, 0x74, 0x04, 0x04, 0x04, 0x35, 0x35, 0x64, 0x64, 0x64,
                           0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x45, 0x56, 0x56,
                           0x56, 0x09, 0x09, 0x09};

    uint8_t expected_data1[] = {0x03, 0x74, 0x83, 0x04, 0x82, 0x35, 0x84, 0x64, 0x85, 0x00, 0x56, 0x45, 0x83, 0x56, 0x83, 0x09,
                                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

    uint8_t data_ptr2[] = {0x03, 0x74, 0x04, 0x04, 0x04, 0x35, 0x35, 0x64, 0x64, 0x64,
                           0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x45, 0x56, 0x57,
                           0x56, 0x09, 0x09, 0x10};

    uint8_t expected_data2[] = {0x03, 0x74, 0x83, 0x04, 0x82, 0x35, 0x84, 0x64, 0x85, 0x00, 0x56, 0x45, 0x56, 0x57, 0x56, 0x82, 0x09, 0x10,
                                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

    TEST_ASSERT_EQUAL(NULL_PTR_PROBLEM, compress_bytes(NULL, 10));

    TEST_ASSERT_EQUAL(16, compress_bytes(data_ptr1, 24));
    TEST_ASSERT_EQUAL_HEX8_ARRAY(data_ptr1, expected_data1, 16);

    TEST_ASSERT_EQUAL(18, compress_bytes(data_ptr2, 24));
    TEST_ASSERT_EQUAL_HEX8_ARRAY(data_ptr2, expected_data2, 18);
}
void test_decompression(void)
{
    uint8_t compressed_data1[] = {0x03, 0x74, 0x83, 0x04, 0x82, 0x35, 0x84, 0x64, 0x85, 0x00, 0x56, 0x45, 0x56, 0x57, 0x56, 0x82, 0x09, 0x10,
                                  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

    uint8_t decompressed_data1[] = {0x03, 0x74, 0x04, 0x04, 0x04, 0x35, 0x35, 0x64, 0x64, 0x64,
                                    0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x45, 0x56, 0x57,
                                    0x56, 0x09, 0x09, 0x10};

    uint8_t decompressed_data2[] = {0x03, 0x74, 0x04, 0x04, 0x04, 0x35, 0x35, 0x64, 0x64, 0x64,
                                    0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x45, 0x56, 0x56,
                                    0x56, 0x09, 0x09, 0x09};

    uint8_t compressed_data2[] = {0x03, 0x74, 0x83, 0x04, 0x82, 0x35, 0x84, 0x64, 0x85, 0x00, 0x56, 0x45, 0x83, 0x56, 0x83, 0x09,
                                  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

    TEST_ASSERT_EQUAL(NULL_PTR_PROBLEM, decompress_bytes(NULL, 10));

    TEST_ASSERT_EQUAL(24, decompress_bytes(compressed_data1, 18));
    TEST_ASSERT_EQUAL_HEX8_ARRAY(decompressed_data1, compressed_data1, 24);

    TEST_ASSERT_EQUAL(24, decompress_bytes(compressed_data2, 16));
    TEST_ASSERT_EQUAL_HEX8_ARRAY(decompressed_data2, compressed_data2, 24);
}
int main(void)
{
    /* Initiate the Unity Test Framework */
    UNITY_BEGIN();

    /* Run Test functions */
    RUN_TEST(test_compression);
    RUN_TEST(test_decompression);

    /* Close the Unity Test Framework */
    return UNITY_END();
}